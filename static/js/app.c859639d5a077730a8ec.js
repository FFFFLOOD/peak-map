webpackJsonp([2],{"9SxT":function(n,e,t){"use strict";var o={angle:0,currentState:"intro",lineDensity:28,lineWidth:1,smoothSteps:1,mapOpacity:100,heightScale:42,oceanLevel:0,aboutVisible:!1,error:null,zazzleLink:null,generatingPreview:!1,settingsOpen:!1,shouldDraw:!1,renderProgress:null,width:window.innerWidth,height:window.innerHeight,backgroundColor:{r:247,g:242,b:232,a:1},lineBackground:{r:247,g:242,b:232,a:1},lineColor:{r:22,g:22,b:22,a:1}};e.a=o},NHnr:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=t("9SxT"),a=t("1e2d"),r=t.n(a),i=t("5dBV"),l=t.n(i);function c(n,e,t){var o=void 0;return a(),{cancel:function(){cancelAnimationFrame(o),n.renderProgress=null},render:a};function a(){n.renderProgress&&(n.renderProgress.message="Rendering...");var a=l()(n.oceanLevel),i=parseFloat(n.smoothSteps);t.style.opacity=n.mapOpacity/100;var c=t.getContext("2d"),u=r(n.lineColor),m=r(n.lineBackground),s=l()(n.lineWidth),d=window.innerHeight,h=window.innerWidth,g=Math.round(d*n.lineDensity/100),f=n.heightScale,v=e.getAllHeightData(),w=v.minHeight,p=v.maxHeight,y=v.rowWithHighestPoint,x=function(n,e,t){var o=Math.round(e/n);return{start:t-Math.floor(t/o)*o,step:o,stop:e}}(g,d,y),b=p-w,P=[],H=x.start;function T(n){if(!(n.length<3)){var e=function(n,e){for(var t=[],o=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,r=n.length/2,i=0;i<r;i+=1){for(var l=i-e,c=l>=0?l:0,u=i+e+1,m=0,s=0,d=c;d<u&&d<r;d+=1)s+=n[2*d+1],m+=1;var h=s/m;t[2*i]=n[2*i],t[2*i+1]=h,o<h&&(o=h),a>h&&(a=h)}return{points:t,min:a,max:o}}(n,i);if(n=e.points,e.max-e.min>2){c.beginPath(),c.fillStyle=m,c.moveTo(n[0],n[1]);for(var t=2;t<n.length;t+=2)c.lineTo(n[t],n[t+1]);c.lineTo(n[n.length-2],e.max),c.lineTo(n[0],e.max),c.closePath(),c.fill()}c.beginPath(),c.strokeStyle=u,c.lineWidth=s,c.moveTo(n[0],n[1]);for(var o=2;o<n.length;o+=2)c.lineTo(n[o],n[o+1]);c.stroke()}}c.beginPath(),c.clearRect(0,0,h,d),c.fillStyle=r(n.backgroundColor),c.fillRect(0,0,h,d),function t(){var r=performance.now();for(var i=H;i<x.stop;i+=x.step){T(P),P=[];for(var l=0;l<window.innerWidth;++l){var c=e.getHeightAtPoint(l,i),u=i-Math.floor(f*(c-w)/b);c<=a?(T(P),P=[]):P.push(l,u)}H=i+x.step;var m=performance.now()-r;if(m>200)return void(o=requestAnimationFrame(t))}T(P);n.renderProgress=null}()}function r(n){return"rgba("+n.r+", "+n.g+", "+n.b+", "+n.a+")"}}var u="pk.eyJ1IjoiYW52YWthIiwiYSI6ImNrNWRqcDdnNTF4MHYzbXAzNDJzODludnYifQ.2WDAbuAzUuchNtCAcZitAw",m=t("//Fk"),s=t.n(m),d=t("ifoU"),h="https://api.mapbox.com/v4/mapbox.terrain-rgb/zoom/tLong/tLat@2x.pngraw?access_token="+u,g=new(t.n(d).a);function f(n,e,t){e||(e={});var o=512,a=n.transform.tileZoom,r=Math.pow(2,a),i=n.transform.coveringTiles({minzoom:a,maxzoom:a,tileSize:o}),l=i.reduce(function(n,e){var t=e.canonical;return n.minX>t.x&&(n.minX=t.x),n.minY>t.y&&(n.minY=t.y),n.maxX<t.x&&(n.maxX=t.x),n.maxY<t.y&&(n.maxY=t.y),n},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),c=document.createElement("canvas"),u=l.maxX-l.minX,m=l.maxY-l.minY;if(u>50||m>50)throw new Error("Too many tiles requested. How did you do it?");c.width=u*o+o,c.height=m*o+o;var d=c.getContext("2d"),f=l.minX,v=l.minY;e.total=i.length,x();var w=void 0,p=!1,y=i.map(function(n){var e=function(n){var e=n.canonical;return{url:h.replace("zoom",e.z).replace("tLat",e.y).replace("tLong",e.x),x:o*(e.x-l.minX),y:o*(e.y-l.minY)}}(n);return(t=e.url,a=g.get(t),a||(a=new s.a(function(n,e){var o=new Image;o.onload=function(){n(o)},o.onerror=e,o.crossOrigin="anonymous",o.src=t}),g.set(t,a)),a).then(function(n){d.drawImage(n,e.x,e.y)}).catch(function(){d.beginPath(),d.fillStyle="#0186a0",d.fillRect(e.x,e.y,o,o)}).finally(x);var t,a});return s.a.all(y).then(function(){var e=c.width,t=d.getImageData(0,0,e,c.height).data,a=window.innerWidth,i=window.innerHeight,l=new Float32Array(a*i),u=void 0,m=16,h=1/0,g=-1/0,y=-1,x=0;return w=requestAnimationFrame(function n(){for(var e=window.performance.now(),t=x;t<i;++t){for(var o=0;o<a;++o){var r=t*a+o,c=b(o,t);l[r]=c,c<h&&(h=c),c>g&&(g=c,y=t)}var s=window.performance.now()-e;if(s>m)return void(p||(w=requestAnimationFrame(n)));x=t}u({minHeight:h,maxHeight:g,rowWithHighestPoint:y,allHeights:l,windowWidth:a,windowHeight:i})}),new s.a(function(n){u=n});function b(a,i){var l=n.transform.pointLocation({x:a,y:i}),c=function(n,e){return(n+180)/360*e}(l.lng,r),u=(c-f)*o,m=function(n,e){var t=n*Math.PI/180;return(1-Math.log(Math.tan(t)+1/Math.cos(t))/Math.PI)/2*e}(l.lat,r),s=(m-v)*o,d=Math.round(s),h=Math.round(u),g=4*(d*e+h),w=t[g+0],p=t[g+1],y=t[g+2];return function(n,e,t){var o=.1*(256*n*256+256*e+t)-1e4;o<-100&&(o/=5e3);return o}(w,p,y)}}).then(function(n){var e=n.windowWidth,t=n.allHeights;return{getHeightAtPoint:function(n,o){return t[n+o*e]},getAllHeightData:function(){return n}}}).then(function(n){p||t(n)}),{cancel:function(){p=!0,cancelAnimationFrame(w)}};function x(){void 0===e.completed&&(e.completed=-1),e.completed=Math.min(e.total,e.completed+1),e.message="Downloading tiles: "+e.completed+" of "+e.total+"..."}}var v=t("xQT3");t.e(0).then(function(){t("WOBu")}.bind(null,t)).catch(t.oe);var w=void 0,p=void 0,y=void 0;function x(){o.a.zazzleLink=null;var n=document.querySelector(".height-map");n&&(n.style.opacity=.02)}function b(){if(w){var n=document.querySelector(".height-map");n&&(p&&p.cancel(),y&&y.cancel(),o.a.shouldDraw?(n.style.display="",o.a.renderProgress={message:"",isCancelled:!1,completed:!1},y=f(w,o.a.renderProgress,function(e){p=c(o.a,e,n)})):n.style.display="none")}}o.a.init=function(){r.a.accessToken=u,window.map=w=new r.a.Map({trackResize:!0,container:"map",minZoom:0,style:"mapbox://styles/mapbox/light-v10",center:[-122.574,47.727],zoom:7.68,hash:!0}),w.addControl(new r.a.NavigationControl({showCompass:!1}),"bottom-right"),w.addControl(new v({accessToken:r.a.accessToken})),w.on("moveend",function(){w.once("idle",b)}),w.on("movestart",x),w.on("load",function(){o.a.angle=w.getBearing()}),w.dragRotate.disable(),w.touchZoomRotate.disableRotation()},o.a.redraw=function(){if(!p)return;p.cancel(),p.render()},o.a.updateMap=b}},["NHnr"]);
//# sourceMappingURL=app.c859639d5a077730a8ec.js.map